# Copyright (C) 2023-2025 Cognizant Digital Business, Evolutionary AI.
# All Rights Reserved.
# Issued under the Academic Public License.
#
# You can be released from the terms, and requirements of the Academic Public
# License by purchasing a commercial license.
# Purchase of a commercial license is mandatory for any use of the
# neuro-san SDK Software in commercial settings.
#
# END COPYRIGHT

# To use this agent network, you will need to
# - pip install -U langchain-google-community\[gmail\]
# - set up your credentials explained in 
# https://developers.google.com/workspace/gmail/api/quickstart/python#authorize_credentials_for_a_desktop_application.
# Once you've downloaded the credentials.json file and put it in the top level of this repo,
# you can start using the agent network.

{
    "llm_config": {
        "model_name": "gpt-4o",
    },
    "max_execution_seconds": 6000,
    "tools": [
        {
            "name": "Agent Network Architect",
            "function": {
                description = "Designs a multi-agent network and can email the configuration HOCON file to specified recipients."
            },
            "instructions": """
You are a helpful assistant that supports users in building agent networks.

Only respond to inquiries that are directly related to your area of expertiseâ€”agent network design and configuration. Do not attempt to assist with unrelated matters. Avoid mentioning what you cannot do; focus only on what you can do.

Begin by asking for the name of a company, organization, or a description of the target domain. This context will be used to guide the network design.

Use the '/agent_network_designer' tool to generate the network configuration (typically in HOCON format).
The response from this tool will include the name of the agent network in the sentence: 
'You are part of a <agent_network_name> of assistants.'
and avoid repeating the line: 'You are part of a <agent_network_name> of assistants.' in your response.

The configuration file will be located at:  
`registries/<agent_network_name>.hocon`

When answering questions about the agent network, only use information provided in the tool response. Do not invent or infer additional details beyond what the tool has returned.

If the user asks you to test the agent network, use the 'agent_network_tester' tool.
ALWAYS include the following two things in your reply:
1. The exact test query you sent to the network.
2. The response you received from the network.

Do not summarize. Show both clearly and completely.

If the user asks you to create a graph or visualization of the agent network, use the 'agent_network_html_generator' tool.

If the user requests it, use the 'gmail_handler_with_attachment' tool to email the generated file to a specified email address.

Always ask for clarification if the user's intent is ambiguous.
""",
            "allow": {
                "to_upstream": {
                    "sly_data": {
                        "AutomaticallyDesignedAgentNetwork": true,
                    }
                }
                "from_downstream": {
                    "sly_data": {
                        "AutomaticallyDesignedAgentNetwork": true,
                    }
                }
            },
            "tools": ["/agent_network_designer", "agent_network_html_generator", "agent_network_tester", "gmail_handler_with_attachment"]
        },

        {
            "name": "agent_network_html_generator",
            "toolbox": "agent_network_html_generator"
        },

        {
            "name": "agent_network_tester",
            "function": {
                "description": "Test the agent network by sending it a test or sample query.",
                "parameters": {
                    "type": "object",
                    "properties": {
                        "agent_name": {
                            "type": string,
                            "description": "Name of the agent to test"
                        },
                        "query": {
                            "type": "string",
                            "description": "Query for the test"
                        }
                    },
                    "required": ["agent_name", "query"]
                }
            },
            "class": "nsflow_selenium.NsflowSelenium"
            "args": {
                # User-defined arguments for the tool

                # --- Required Argument ---

                # URL for connecting to nsflow
                "url": "http://localhost:4174",

                # --- Optional Arguments ---

                # Time in second for selenium to wait for each element to load or appear
                "time_to_find_element": 120.0,

                # Time in second to wait before clicking send after the text input
                "time_before_click_send": 2.0,

                # Time in second before closing the browser after the agent responses
                "time_after_response_before_close": 10.0
            }
        },

        {
            "name": "gmail_handler_with_attachment",

            # "send_gmail_message_with_attachment" is a coded tool from the toolbox located at toolbox/toolbox_info.hocon
            # This tool is solely for sending an email with attachment.
            # The code of this tool can be found at coded_tools/gmail_attachment.py
            "toolbox": "send_gmail_message_with_attachment"
        }
    ]
}
